% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prepare_sets.R
\name{prepare_sets}
\alias{prepare_sets}
\title{Prepare Pathway Gene Sets from Enrichment Results}
\usage{
prepare_sets(enrichment_df, expr, sep = NULL)
}
\arguments{
\item{enrichment_df}{A data.frame containing at least two columns. The function
uses the first two columns only:
\describe{
\item{Column 1}{Pathway/term identifiers (names of gene sets).}
\item{Column 2}{Gene hits as a single character string, with genes separated by
commas (\verb{,}) or slashes (\code{/}).}
}}

\item{expr}{A numeric matrix or data.frame of expression values with gene identifiers
in \code{rownames(expr)}. Gene sets are filtered to retain only genes present in
\code{rownames(expr)}.}

\item{sep}{Optional character separator used in the gene-hit column. If \code{NULL}
(default), the separator is inferred: if any \code{hits} contains \code{","} then \code{","}
is used, otherwise \code{"/"} is used.}
}
\value{
A named list where each element is a character vector of genes for one
pathway/term. Pathways with no genes after filtering are removed.
}
\description{
Converts an enrichment results table (terms and gene hits) into a named list of
pathway gene sets, optionally filtering each gene set to genes present in an
expression matrix.
}
\details{
The function performs the following steps:
\enumerate{
\item Keeps only the first two columns of \code{enrichment_df} and renames them to
\code{terms} and \code{hits}.
\item Determines a separator (\code{sep}) if not provided.
\item Converts the term/hits table into a named list using \code{tibble::deframe()}.
\item Splits each hit string into a character vector of genes using \code{strsplit()}.
\item Filters genes to those present in \code{rownames(expr)}.
\item Drops pathways with zero remaining genes.
}
}
\examples{
\dontrun{
enrichment_df <- data.frame(
  pathwayID = c("Pathway_A", "Pathway_B"),
  geneID = c("TP53/BRCA1/EGFR", "MTOR/PIK3CA")
)

expr <- matrix(rnorm(25), nrow = 5)
rownames(expr) <- c("TP53", "BRCA1", "EGFR", "MTOR", "PIK3CA")

gset_list <- prepare_sets(enrichment_df, expr)
names(gset_list)
gset_list[[1]]
}
}
