% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_interactions.R
\name{compute_interactions}
\alias{compute_interactions}
\title{Compute Pathway–Pathway Interaction Statistics from a Gene–Gene MI Network}
\usage{
compute_interactions(p_graph, g_graph, terms, genes)
}
\arguments{
\item{p_graph}{A directed \pkg{igraph} object encoding pathway membership edges.
After conversion with \code{\link[igraph:as_edgelist]{igraph::as_edgelist()}}, the first column is interpreted as
genes and the second as terms/pathways (i.e., each edge indicates a gene belongs to
a pathway).}

\item{g_graph}{An undirected \pkg{igraph} gene–gene interaction graph. Edges are expected
to carry a numeric attribute named \code{mi_score}, used as MI weights via
\code{\link[igraph:as_adjacency_matrix]{igraph::as_adjacency_matrix()}}. The unweighted adjacency is used to
compute interaction degree.}

\item{terms}{Character vector of term/pathway identifiers used as the column names of the
incidence matrix (must match the term labels in \code{p_graph}).}

\item{genes}{Character vector of gene identifiers used as the row names of the incidence
matrix (must match the gene labels in \code{p_graph} and the vertices in \code{g_graph}).}
}
\value{
A \code{data.frame} with one row per unique pathway pair and columns:
\describe{
\item{Term1}{First pathway/term identifier.}
\item{Term2}{Second pathway/term identifier.}
\item{degree}{Number of gene–gene edges connecting the two terms.}
\item{deg_norm}{Degree normalized by \eqn{|p| + |q|}.}
\item{mi_score}{Sum of \code{mi_score} across gene–gene edges connecting the two terms.}
\item{mi_norm}{\code{mi_score} normalized by \eqn{|p| + |q|}.}
}
}
\description{
Compute pairwise interaction metrics between pathways/terms using (i) a gene→term
membership graph and (ii) a gene–gene interaction graph carrying mutual information
(MI) weights. For each pathway pair, the function summarizes the number of connecting
gene–gene edges (degree) and the total/normalized MI across those edges.
}
\details{
The pathway membership graph is converted to a sparse gene × term incidence matrix \eqn{M}.
Two gene–gene adjacency matrices are derived from \code{g_graph}:
\itemize{
\item \eqn{A}: weighted adjacency using edge attribute \code{mi_score}
\item \eqn{B}: unweighted adjacency (presence/absence)
}

Pathway–pathway matrices are computed as:
\deqn{MI = M^\top A M}
\deqn{Degree = M^\top B M}
Diagonals are set to zero (no self-interactions). The output is restricted to unique
pathway pairs (upper triangle).

Normalization uses pathway sizes \eqn{|p|} and \eqn{|q|} (column sums of \eqn{M}):
\deqn{mi\_norm(p,q) = mi(p,q) / (|p| + |q|)}
and similarly for degree (\code{deg_norm}).
}
\examples{
\dontrun{
out <- compute_interactions(p_graph, g_graph, terms, genes)
head(out)
}
}
