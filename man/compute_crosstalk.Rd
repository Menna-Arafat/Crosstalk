% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_crosstalk.R
\name{compute_crosstalk}
\alias{compute_crosstalk}
\title{Cross-talk Analysis Between Terms Using Mutual Information and Permutation Testing}
\usage{
compute_crosstalk(gset_list, mi_df, iter = 100, prefix = "res")
}
\arguments{
\item{gset_list}{A \strong{named} list of character vectors, where each element is a term
gene set. Gene identifiers must match the vertex names used in \code{mi_df} (edge endpoints).}

\item{mi_df}{A \code{data.frame} describing a gene–gene interaction network. Must contain at
least two columns defining edge endpoints (gene identifiers) and an edge attribute
column named \code{mi_score} used as MI weights. The table is converted internally to an
undirected \pkg{igraph} graph.}

\item{iter}{Integer. Number of permutations used to generate the null distribution.
Default is \code{100}.}

\item{prefix}{Character. Prefix used when writing results to disk. The output file is
written as \code{paste0(prefix, "_CrosstalkX.csv")}. Default is \code{"res"}.}
}
\value{
A \code{data.frame} of pairwise term interactions containing (at minimum):
\describe{
\item{Term1}{First term identifier.}
\item{Term2}{Second term identifier.}
\item{degree}{Number of gene–gene edges connecting the two terms.}
\item{deg_norm}{\code{degree} normalized by \eqn{|t_1| + |t_2|}.}
\item{mi_score}{Sum of MI (\code{mi_score}) across connecting edges.}
\item{mi_norm}{\code{mi_score} normalized by \eqn{|t_1| + |t_2|}.}
\item{Jaccard}{Jaccard similarity between term gene sets.}
\item{pval_deg_norm}{Permutation p-value for \code{deg_norm} (one-sided, \eqn{\ge}).}
\item{pval_mi_norm}{Permutation p-value for \code{mi_norm} (one-sided, \eqn{\ge}).}
\item{Term1_hits}{Comma-separated genes in \code{Term1} after filtering to the gene graph.}
\item{Term2_hits}{Comma-separated genes in \code{Term2} after filtering to the gene graph.}
}
}
\description{
Perform permutation-based inference of significant term–term cross-talk using mutual
information (MI) and interaction degree derived from a gene–gene interaction network.
Terms are represented as gene sets; observed term–term connectivity is compared to a
null distribution generated by randomizing the gene→term membership structure while
approximately preserving degree constraints.
}
\details{
The procedure:
\enumerate{
\item Constructs an undirected gene–gene graph from \code{mi_df}.
\item Filters each gene set in \code{gset_list} to genes present in the gene graph; empty
terms are dropped.
\item Builds a directed membership graph with edges gene \eqn{\rightarrow} term using
\code{stack(gset_list)} and \code{\link[igraph:graph_from_data_frame]{igraph::graph_from_data_frame()}}.
\item Computes observed term–term interaction statistics with
\code{\link[=compute_interactions]{compute_interactions()}} and overlap (Jaccard) with \code{\link[=compute_jaccard]{compute_jaccard()}}, then joins
the results by (\code{Term1}, \code{Term2}).
\item Generates a null distribution by sampling directed graphs with fixed in/out
degree sequences via \code{\link[igraph:sample_degseq]{igraph::sample_degseq()}}. For each
successful permutation, term–term interaction statistics are recomputed.
\item Computes one-sided empirical permutation p-values using:
\deqn{p = \frac{\#\{T_b \ge T_{obs}\} + 1}{B + 1}}
where \eqn{T} is the statistic of interest and \eqn{B} is the number of successful
permutations.
\item Adds term gene-hit strings (\code{Term1_hits}, \code{Term2_hits}) for interpretability and
writes results to disk with \code{\link[data.table:fwrite]{data.table::fwrite()}}.
}

Permutations that fail (e.g., due to errors during interaction computation) are skipped.
}
\examples{
\dontrun{
gset_list <- list(
  TermA = c("TP53", "EGFR", "MYC"),
  TermB = c("EGFR", "KRAS")
)

mi_df <- data.frame(
  from = c("TP53", "EGFR", "MYC"),
  to   = c("EGFR", "KRAS", "KRAS"),
  mi_score = c(0.6, 0.1, 0.004)
)

res <- compute_crosstalk(gset_list, mi_df, iter = 100, prefix = "demo")
head(res)
}
}
\seealso{
\code{\link[=compute_interactions]{compute_interactions()}}, \code{\link[=compute_jaccard]{compute_jaccard()}}
}
