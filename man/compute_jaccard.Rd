% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_jaccard.R
\name{compute_jaccard}
\alias{compute_jaccard}
\title{Compute Pairwise Jaccard Similarity Between Terms}
\usage{
compute_jaccard(p_graph, terms, genes)
}
\arguments{
\item{p_graph}{A directed \pkg{igraph} object encoding membership edges. After
conversion with \code{\link[igraph:as_edgelist]{igraph::as_edgelist()}}, the first column is interpreted as genes
and the second as terms (i.e., each edge indicates that a gene belongs to a term).}

\item{terms}{Character vector of term identifiers defining the column order
(and column names) of the incidence matrix.}

\item{genes}{Character vector of gene identifiers defining the row order
(and row names) of the incidence matrix.}
}
\value{
A \code{data.frame} with one row per unique term pair and columns:
\describe{
\item{Term1}{First term identifier.}
\item{Term2}{Second term identifier.}
\item{Jaccard}{Jaccard similarity between the two terms.}
}
}
\description{
Compute Jaccard similarity between all term pairs based on gene-set overlap.
The function converts a gene→term membership graph into a sparse gene × term
incidence matrix and derives pairwise intersections/unions via matrix
cross-products.
}
\details{
A sparse incidence matrix \eqn{M} is constructed where \eqn{M[g,t] = 1} if gene \eqn{g}
belongs to term \eqn{t}. For each term pair \eqn{(t_1, t_2)}:
\itemize{
\item Intersections \eqn{|G_{t_1} \cap G_{t_2}|} are obtained from \eqn{M^\top M}.
\item Term sizes \eqn{|G_t|} are obtained from column sums of \eqn{M}.
\item Unions are computed as \eqn{|G_{t_1} \cup G_{t_2}| = |G_{t_1}| + |G_{t_2}| - |G_{t_1} \cap G_{t_2}|}.
\item Jaccard similarity is \eqn{J(t_1,t_2) = |G_{t_1} \cap G_{t_2}| / |G_{t_1} \cup G_{t_2}|}.
}

The diagonal of the similarity matrix is set to 1, but the returned table excludes
self-pairs and retains only unique term pairs (upper triangle).
}
\examples{
\dontrun{
edges <- data.frame(
  gene = c("A","B","C","B","D"),
  term = c("T1","T1","T1","T2","T2")
)
p_graph <- igraph::graph_from_data_frame(edges, directed = TRUE)

genes <- unique(edges$gene)
terms <- unique(edges$term)

J <- compute_jaccard(p_graph, terms, genes)
head(J)
}
}
