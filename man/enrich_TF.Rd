% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enrich_TF.R
\name{enrich_TF}
\alias{enrich_TF}
\title{Transcription Factor Enrichment Using decoupleR ULM}
\usage{
enrich_TF(tstat_vec, net, active = TRUE, pvaluecutoff = 0.05, minGSSize = 5)
}
\arguments{
\item{tstat_vec}{A \strong{named} numeric vector of gene-level statistics (e.g., t-statistics,
signed scores). Names must be gene identifiers matching the \code{target} column in \code{net}.}

\item{net}{Optional regulatory network (edge list) used by decoupleR. Must contain at least
three columns corresponding to regulator (\code{source}), target gene (\code{target}), and mode of
regulation (\code{mor}). If \code{NULL}, the dataset \code{net} bundled with \pkg{CrosstalkX} is loaded
and filtered to \code{mor != 0}.}

\item{active}{Logical. If \code{TRUE} (default), retains only TFs with positive ULM score
(\code{score > 0}) in addition to \code{p_value <= pvaluecutoff}. If \code{FALSE}, retains TFs based
on p-value only.}

\item{pvaluecutoff}{Numeric. P-value threshold applied to decoupleR results (\code{p_value}).
Default is \code{0.05}.}

\item{minGSSize}{Integer. Minimum number of target genes per TF used by decoupleR ULM
(\code{minsize} argument). Default is \code{5}.}
}
\value{
A \code{data.frame} with one row per significant TF, containing:
\describe{
\item{source}{TF identifier.}
\item{all_targets}{Slash-separated targets (\code{target}) regulated by the TF among input genes.}
\item{direction}{\code{"up"} if ULM score > 0, otherwise \code{"down"}.}
}
}
\description{
Infers enriched transcription factors (TFs) from a named vector of gene-level statistics
using decoupleR's univariate linear model (ULM). Significant TFs are selected by p-value,
optionally restricted to positively scored ("active") regulators, and the corresponding
TF \eqn{\rightarrow} target network is returned.
}
\details{
The function:
\enumerate{
\item Loads the default network from \pkg{CrosstalkX} if \code{net} is \code{NULL}, and keeps
only signed edges (\code{mor != 0}).
\item Converts \code{tstat_vec} to a matrix and runs \code{decoupleR::run_ulm()} using
\code{source}, \code{target}, and \code{mor} columns from \code{net}.
\item Filters significant TFs by \code{p_value <= pvaluecutoff} and, if \code{active = TRUE},
additionally requires \code{score > 0}.
\item Builds a TF \eqn{\rightarrow} target summary table for significant TFs and returns it.
}

The function writes two CSV files to the current working directory:
\itemize{
\item \code{decoupleR_res.csv}: full ULM results from decoupleR.
\item \code{net_target_net.csv}: summarized TF-target network for significant TFs.
}
}
\examples{
\dontrun{
# tstat_vec must be a named numeric vector of gene statistics:
de_res$t_stat <- de_res$log2FoldChange / de_res$lfcSE
# tstat_vec <- setNames(de_res$t_stat, rownames(de_res))

tf_targets <- enrich_TF(tstat_vec, net = NULL, active = TRUE, pvaluecutoff = 0.05)
head(tf_targets)
}
}
\seealso{
\code{\link[decoupleR]{run_ulm}}
}
