% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enrich_path.R
\name{enrich_path}
\alias{enrich_path}
\title{Pathway Enrichment Analysis from Differential Expression Statistics}
\usage{
enrich_path(de_vec, enrich, gset = NULL, pvalueCutoff = 0.05, FDR = 0.05)
}
\arguments{
\item{de_vec}{A \strong{named} numeric vector of differential expression statistics
(e.g., t-statistics, signed scores, logFC). Names must be gene identifiers compatible
with the gene set collection in \code{gset}. For GSEA, values are used for ranking.}

\item{enrich}{Character string specifying the enrichment method. Must be one of
\code{"GSEA"} or \code{"ORA"}.}

\item{gset}{Optional gene set collection. If \code{NULL}, the dataset \code{gset} bundled with
\pkg{CrosstalkX} is loaded. Expected format is a named list where each element is a
character vector of gene identifiers; list names correspond to pathway/term IDs.}

\item{pvalueCutoff}{Numeric. Raw p-value threshold applied after enrichment. Default is \code{0.05}.}

\item{FDR}{Numeric. Adjusted p-value (FDR; \code{p.adjust}) threshold applied after enrichment.
Default is \code{0.05}.}
}
\value{
A \code{data.frame} of enrichment results. The returned columns follow
\code{clusterProfiler} output and typically include pathway/term identifiers, enrichment
statistics, \code{pvalue}, \code{p.adjust}, and an added \code{direction} column. An \code{input} column
is appended containing the input gene names collapsed into a single string.
}
\description{
Performs pathway enrichment using either gene set enrichment analysis (GSEA) on a ranked
differential-expression vector or over-representation analysis (ORA) on up/down subsets.
If \code{gset} is not supplied, a default gene set collection bundled with \pkg{CrosstalkX}
is loaded.
}
\details{
The function converts \code{gset} into a two-column TERM2GENE table and then:
\itemize{
\item \strong{GSEA}: ranks \code{de_vec} in decreasing order and runs
\code{clusterProfiler::GSEA()} with \code{pvalueCutoff = 1} and \code{minGSSize = 1}.
A \code{direction} column is added based on the sign of NES (\code{"up"} if NES > 0, else \code{"down"}).
\item \strong{ORA}: defines two input gene lists, \code{up} and \code{down}, and runs
\code{clusterProfiler::enricher()} for each. Results are combined and labeled by \code{direction}.
}

Results are filtered using both \code{pvalueCutoff} and \code{FDR} thresholds (applied to \code{pvalue}
and \code{p.adjust}, respectively). The function also adds an \code{input} column containing the
input genes (collapsed with \code{/}) and writes the results to a CSV file in the current
working directory.
}
\examples{
\dontrun{
# de_vec must be a named numeric vector (e.g., fold change):
de_res$FC= 2 ^ de_res$log2FoldChange
de_vec= setNames(de_res$FC, row.names(de_res))

gsea_res <- enrich_path(de_vec, enrich = "GSEA", pvalueCutoff = 0.05, FDR = 0.05)
head(gsea_res)

ora_res  <- enrich_path(de_vec, enrich = "ORA", pvalueCutoff = 0.05, FDR = 0.05)
head(ora_res)
}
}
\seealso{
\code{\link[clusterProfiler]{GSEA}}, \code{\link[clusterProfiler]{enricher}}
}
